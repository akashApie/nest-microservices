(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[222],{2013:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return r(3633)}])},3526:function(e,t,r){"use strict";r.d(t,{Z:function(){return h}});var s=r(5893),n=r(7294),a=r(9008),i=r.n(a),c=r(1664),l=r.n(c),o=r(1163),d=r(9635),u=()=>{let e=(0,o.useRouter)(),[t,r]=n.useState(0);return n.useEffect(()=>{let t=()=>{let e=(0,d.dv)();r(e.reduce((e,t)=>e+t.quantity,0))};return t(),window.addEventListener("storage",t),e.events.on("routeChangeComplete",t),()=>{window.removeEventListener("storage",t),e.events.off("routeChangeComplete",t)}},[e.events]),(0,s.jsx)("nav",{className:"bg-white shadow-md",children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsxs)("div",{className:"flex justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,s.jsx)(l(),{href:"/",className:"text-xl font-bold text-blue-600",children:"Microservices Shop"})}),(0,s.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[(0,s.jsx)(l(),{href:"/products",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium h-16 ".concat("/products"===e.pathname?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Products"}),(0,s.jsx)(l(),{href:"/orders",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium h-16 ".concat("/orders"===e.pathname?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Orders"})]})]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(l(),{href:"/cart",className:"relative inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md ".concat("/cart"===e.pathname?"bg-blue-100 text-blue-700":"text-gray-500 bg-white hover:bg-gray-100"),children:["Cart",t>0&&(0,s.jsx)("span",{className:"absolute -top-2 -right-2 inline-flex items-center justify-center w-5 h-5 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:t})]})})]})})})},m=r(6501),h=e=>{let{children:t,title:r="Microservices Demo"}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{children:[(0,s.jsx)("title",{children:r}),(0,s.jsx)("meta",{name:"description",content:"Microservices demo with Next.js frontend"}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,s.jsx)(u,{}),(0,s.jsx)("main",{className:"flex-1 container py-8",children:t}),(0,s.jsx)("footer",{className:"bg-gray-100 py-6",children:(0,s.jsxs)("div",{className:"container text-center text-gray-600 text-sm",children:["\xa9 ",new Date().getFullYear()," Microservices Demo"]})})]}),(0,s.jsx)(m.x7,{position:"bottom-right"})]})}},3633:function(e,t,r){"use strict";r.r(t);var s=r(5893),n=r(7294),a=r(1163),i=r(3526),c=r(9635),l=r(7829),o=r(6501);t.default=()=>{let e=(0,a.useRouter)(),[t,r]=(0,n.useState)([]),[d,u]=(0,n.useState)(0),[m,h]=(0,n.useState)(!1),[x,p]=(0,n.useState)(""),[f,g]=(0,n.useState)(""),[v,j]=(0,n.useState)(""),[y,b]=(0,n.useState)("");(0,n.useEffect)(()=>{let t=(0,c.dv)();if(0===t.length){e.push("/cart");return}r(t),u((0,c.I3)())},[e]);let N=async r=>{if(r.preventDefault(),0===t.length){o.ZP.error("Your cart is empty!");return}try{h(!0);let r=await (0,l.wK)({name:x,email:f,phone:v,address:y});await (0,l.LV)(r.id,t),(0,c.LL)(),o.ZP.success("Order placed successfully!"),e.push("/orders")}catch(e){console.error("Error placing order:",e),o.ZP.error("Failed to place order. Please try again.")}finally{h(!1)}};return(0,s.jsx)(i.Z,{title:"Checkout | Microservices Shop",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Checkout"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Your Information"}),(0,s.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"form-label",children:"Full Name"}),(0,s.jsx)("input",{id:"name",type:"text",className:"form-input",value:x,onChange:e=>p(e.target.value),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email Address"}),(0,s.jsx)("input",{id:"email",type:"email",className:"form-input",value:f,onChange:e=>g(e.target.value),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"phone",className:"form-label",children:"Phone Number"}),(0,s.jsx)("input",{id:"phone",type:"tel",className:"form-input",value:v,onChange:e=>j(e.target.value),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"address",className:"form-label",children:"Shipping Address"}),(0,s.jsx)("textarea",{id:"address",className:"form-input",rows:3,value:y,onChange:e=>b(e.target.value),required:!0})]}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary w-full ".concat(m?"opacity-50 cursor-not-allowed":""),disabled:m,children:m?"Processing...":"Place Order"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"divide-y divide-gray-200",children:t.map(e=>(0,s.jsxs)("div",{className:"py-3 flex justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.product.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[e.quantity," x $",e.product.price.toFixed(2)]})]}),(0,s.jsxs)("p",{className:"font-medium",children:["$",(e.product.price*e.quantity).toFixed(2)]})]},e.productId))}),(0,s.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,s.jsxs)("div",{className:"flex justify-between text-lg font-bold",children:[(0,s.jsx)("p",{children:"Total"}),(0,s.jsxs)("p",{children:["$",d.toFixed(2)]})]})})]})]})]})]})})}},7829:function(e,t,r){"use strict";r.d(t,{LV:function(){return m},fA:function(){return u},pB:function(){return o},t2:function(){return l},wK:function(){return d}});var s=r(7066),n=r(6501);let a=s.Z.create({baseURL:"http://localhost:3000",timeout:1e4,headers:{"Content-Type":"application/json"}}),i=s.Z.create({baseURL:"http://localhost:3001",timeout:1e4,headers:{"Content-Type":"application/json"}}),c=e=>{if(s.Z.isAxiosError(e)){var t,r;let s=(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||e.message||"An error occurred";throw console.error("API Error:",s),n.ZP.error(s),Error(s)}throw console.error("Unexpected error:",e),n.ZP.error("An unexpected error occurred"),e},l=async()=>{try{let e=await i.get("/products");return e.data}catch(e){return c(e)}},o=async e=>{try{let t=await a.get("/customers/".concat(e));return t.data}catch(e){return c(e)}},d=async e=>{try{let t=await a.post("/customers",e);return t.data}catch(e){return c(e)}},u=async e=>{try{let t=await i.get("/orders/customer/".concat(e));return t.data}catch(e){return c(e)}},m=async(e,t)=>{try{let r=t.map(e=>({productId:e.productId,quantity:e.quantity,price:e.product.price})),s=await i.post("/orders",{customerId:e,items:r,status:"pending"});return s.data}catch(e){return c(e)}}},9635:function(e,t,r){"use strict";r.d(t,{I3:function(){return l},LL:function(){return c},Xq:function(){return n},a3:function(){return a},dv:function(){return s},h2:function(){return i}});let s=()=>{let e=localStorage.getItem("cart");return e?JSON.parse(e):[]},n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=s(),n=r.findIndex(t=>t.productId===e.id);n>=0?r[n].quantity+=t:r.push({productId:e.id,product:e,quantity:t}),localStorage.setItem("cart",JSON.stringify(r))},a=(e,t)=>{let r=s(),n=r.findIndex(t=>t.productId===e);n>=0&&(t<=0?r.splice(n,1):r[n].quantity=t,localStorage.setItem("cart",JSON.stringify(r)))},i=e=>{let t=s(),r=t.filter(t=>t.productId!==e);localStorage.setItem("cart",JSON.stringify(r))},c=()=>{localStorage.setItem("cart",JSON.stringify([]))},l=()=>{let e=s();return e.reduce((e,t)=>e+t.product.price*t.quantity,0)}}},function(e){e.O(0,[949,66,774,888,179],function(){return e(e.s=2013)}),_N_E=e.O()}]);