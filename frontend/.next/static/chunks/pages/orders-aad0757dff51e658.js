(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[660],{131:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orders",function(){return r(8441)}])},3526:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var s=r(5893),n=r(7294),a=r(9008),c=r.n(a),i=r(1664),l=r.n(i),d=r(1163),o=r(9635),u=()=>{let e=(0,d.useRouter)(),[t,r]=n.useState(0);return n.useEffect(()=>{let t=()=>{let e=(0,o.dv)();r(e.reduce((e,t)=>e+t.quantity,0))};return t(),window.addEventListener("storage",t),e.events.on("routeChangeComplete",t),()=>{window.removeEventListener("storage",t),e.events.off("routeChangeComplete",t)}},[e.events]),(0,s.jsx)("nav",{className:"bg-white shadow-md",children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsxs)("div",{className:"flex justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,s.jsx)(l(),{href:"/",className:"text-xl font-bold text-blue-600",children:"Microservices Shop"})}),(0,s.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[(0,s.jsx)(l(),{href:"/products",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium h-16 ".concat("/products"===e.pathname?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Products"}),(0,s.jsx)(l(),{href:"/orders",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium h-16 ".concat("/orders"===e.pathname?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Orders"})]})]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(l(),{href:"/cart",className:"relative inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md ".concat("/cart"===e.pathname?"bg-blue-100 text-blue-700":"text-gray-500 bg-white hover:bg-gray-100"),children:["Cart",t>0&&(0,s.jsx)("span",{className:"absolute -top-2 -right-2 inline-flex items-center justify-center w-5 h-5 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:t})]})})]})})})},x=r(6501),m=e=>{let{children:t,title:r="Microservices Demo"}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c(),{children:[(0,s.jsx)("title",{children:r}),(0,s.jsx)("meta",{name:"description",content:"Microservices demo with Next.js frontend"}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,s.jsx)(u,{}),(0,s.jsx)("main",{className:"flex-1 container py-8",children:t}),(0,s.jsx)("footer",{className:"bg-gray-100 py-6",children:(0,s.jsxs)("div",{className:"container text-center text-gray-600 text-sm",children:["\xa9 ",new Date().getFullYear()," Microservices Demo"]})})]}),(0,s.jsx)(x.x7,{position:"bottom-right"})]})}},8441:function(e,t,r){"use strict";r.r(t);var s=r(5893),n=r(7294),a=r(1163),c=r(1664),i=r.n(c),l=r(3526),d=r(7829);t.default=()=>{(0,a.useRouter)();let[e,t]=(0,n.useState)([]),[r,c]=(0,n.useState)(null),[o,u]=(0,n.useState)(!0),[x,m]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=()=>localStorage.getItem("customerId"),r=async()=>{try{u(!0);let r=e();if(!r){m("No customer found. Please complete a purchase first."),u(!1);return}let s=await (0,d.pB)(r);c(s);let n=await (0,d.fA)(r);t(n),m(null)}catch(e){console.error("Failed to fetch orders:",e),m("Failed to load orders. Please try again later.")}finally{u(!1)}};r()},[]),(0,s.jsx)(l.Z,{title:"Orders | Microservices Shop",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Your Orders"}),o&&(0,s.jsx)("div",{className:"text-center py-10",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Loading orders..."})}),x&&(0,s.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:[(0,s.jsx)("p",{children:x}),x.includes("customer")&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(i(),{href:"/products",className:"btn btn-primary",children:"Browse Products"})})]}),!o&&!x&&r&&(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-blue-800",children:"Customer Information"}),(0,s.jsx)("p",{className:"text-blue-700",children:r.name}),(0,s.jsx)("p",{className:"text-blue-600",children:r.email}),r.phone&&(0,s.jsx)("p",{className:"text-blue-600",children:r.phone})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-sm text-blue-600",children:[e.length," order",1!==e.length?"s":""," placed"]})})]})}),!o&&!x&&0===e.length&&(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"You haven't placed any orders yet."}),(0,s.jsx)(i(),{href:"/products",className:"btn btn-primary",children:"Browse Products"})]}),(0,s.jsx)("div",{className:"space-y-6",children:e.map(e=>(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold",children:["Order #","string"==typeof e.id?e.id.substring(0,8):e.id]}),(0,s.jsxs)("p",{className:"text-gray-500",children:["Placed: ",new Date(e.orderDate||e.createdAt).toLocaleDateString()," at ",new Date(e.orderDate||e.createdAt).toLocaleTimeString()]})]}),(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("completed"===e.status?"bg-green-100 text-green-800":"processing"===e.status?"bg-blue-100 text-blue-800":"cancelled"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})})]}),(0,s.jsx)("h4",{className:"text-md font-medium mb-2",children:"Items"}),(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200",children:(e.items||e.orderItems||[]).map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2",children:e.product?e.product.name:"Product #".concat(e.productId)}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.quantity}),(0,s.jsxs)("td",{className:"px-4 py-2",children:["$",e.price.toFixed(2)]}),(0,s.jsxs)("td",{className:"px-4 py-2",children:["$",(e.price*e.quantity).toFixed(2)]})]},e.id))})]})}),(0,s.jsxs)("div",{className:"flex justify-between border-t pt-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-gray-600",children:["Order ID: ",(0,s.jsx)("span",{className:"font-mono",children:e.id})]}),"pending"===e.status&&(0,s.jsx)("p",{className:"text-yellow-600 mt-2",children:"Your order is being processed. You'll receive an update once it ships."})]}),(0,s.jsxs)("div",{className:"text-lg font-bold",children:["Total: $",e.totalAmount.toFixed(2)]})]})]})},e.id))}),!o&&!x&&e.length>0&&(0,s.jsx)("div",{className:"mt-8 text-center",children:(0,s.jsx)(i(),{href:"/products",className:"btn btn-primary",children:"Shop More Products"})})]})})}},7829:function(e,t,r){"use strict";r.d(t,{LV:function(){return x},fA:function(){return u},pB:function(){return d},t2:function(){return l},wK:function(){return o}});var s=r(7066),n=r(6501);let a=s.Z.create({baseURL:"http://localhost:3000",timeout:1e4,headers:{"Content-Type":"application/json"}}),c=s.Z.create({baseURL:"http://localhost:3001",timeout:1e4,headers:{"Content-Type":"application/json"}}),i=e=>{if(s.Z.isAxiosError(e)){var t,r;let s=(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||e.message||"An error occurred";throw console.error("API Error:",s),n.ZP.error(s),Error(s)}throw console.error("Unexpected error:",e),n.ZP.error("An unexpected error occurred"),e},l=async()=>{try{let e=await c.get("/products");return e.data}catch(e){return i(e)}},d=async e=>{try{let t=await a.get("/customers/".concat(e));return t.data}catch(e){return i(e)}},o=async e=>{try{let t=await a.post("/customers",e);return t.data}catch(e){return i(e)}},u=async e=>{try{let t=await c.get("/orders/customer/".concat(e));return t.data}catch(e){return i(e)}},x=async(e,t)=>{try{let r=t.map(e=>({productId:e.productId,quantity:e.quantity,price:e.product.price})),s=await c.post("/orders",{customerId:e,items:r,status:"pending"});return s.data}catch(e){return i(e)}}},9635:function(e,t,r){"use strict";r.d(t,{I3:function(){return l},LL:function(){return i},Xq:function(){return n},a3:function(){return a},dv:function(){return s},h2:function(){return c}});let s=()=>{let e=localStorage.getItem("cart");return e?JSON.parse(e):[]},n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=s(),n=r.findIndex(t=>t.productId===e.id);n>=0?r[n].quantity+=t:r.push({productId:e.id,product:e,quantity:t}),localStorage.setItem("cart",JSON.stringify(r))},a=(e,t)=>{let r=s(),n=r.findIndex(t=>t.productId===e);n>=0&&(t<=0?r.splice(n,1):r[n].quantity=t,localStorage.setItem("cart",JSON.stringify(r)))},c=e=>{let t=s(),r=t.filter(t=>t.productId!==e);localStorage.setItem("cart",JSON.stringify(r))},i=()=>{localStorage.setItem("cart",JSON.stringify([]))},l=()=>{let e=s();return e.reduce((e,t)=>e+t.product.price*t.quantity,0)}}},function(e){e.O(0,[949,66,774,888,179],function(){return e(e.s=131)}),_N_E=e.O()}]);