(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[345],{4918:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/products",function(){return r(5585)}])},3526:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var s=r(5893),n=r(7294),a=r(9008),c=r.n(a),o=r(1664),i=r.n(o),l=r(1163),d=r(9635),u=()=>{let e=(0,l.useRouter)(),[t,r]=n.useState(0);return n.useEffect(()=>{let t=()=>{let e=(0,d.dv)();r(e.reduce((e,t)=>e+t.quantity,0))};return t(),window.addEventListener("storage",t),e.events.on("routeChangeComplete",t),()=>{window.removeEventListener("storage",t),e.events.off("routeChangeComplete",t)}},[e.events]),(0,s.jsx)("nav",{className:"bg-white shadow-md",children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsxs)("div",{className:"flex justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,s.jsx)(i(),{href:"/",className:"text-xl font-bold text-blue-600",children:"Microservices Shop"})}),(0,s.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[(0,s.jsx)(i(),{href:"/products",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium h-16 ".concat("/products"===e.pathname?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Products"}),(0,s.jsx)(i(),{href:"/orders",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium h-16 ".concat("/orders"===e.pathname?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Orders"})]})]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(i(),{href:"/cart",className:"relative inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md ".concat("/cart"===e.pathname?"bg-blue-100 text-blue-700":"text-gray-500 bg-white hover:bg-gray-100"),children:["Cart",t>0&&(0,s.jsx)("span",{className:"absolute -top-2 -right-2 inline-flex items-center justify-center w-5 h-5 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:t})]})})]})})})},x=r(6501),m=e=>{let{children:t,title:r="Microservices Demo"}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c(),{children:[(0,s.jsx)("title",{children:r}),(0,s.jsx)("meta",{name:"description",content:"Microservices demo with Next.js frontend"}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,s.jsx)(u,{}),(0,s.jsx)("main",{className:"flex-1 container py-8",children:t}),(0,s.jsx)("footer",{className:"bg-gray-100 py-6",children:(0,s.jsxs)("div",{className:"container text-center text-gray-600 text-sm",children:["\xa9 ",new Date().getFullYear()," Microservices Demo"]})})]}),(0,s.jsx)(x.x7,{position:"bottom-right"})]})}},5585:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var s=r(5893),n=r(7294),a=r(3526),c=r(9635),o=r(6501),i=e=>{let{product:t}=e;return(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:t.name}),(0,s.jsx)("p",{className:"text-gray-600 text-sm mb-2 flex-grow",children:t.description}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-xl font-bold",children:["$",t.price.toFixed(2)]}),(0,s.jsx)("span",{className:"text-sm ".concat(t.stock>5?"text-green-600":"text-red-600"),children:t.stock>0?"".concat(t.stock," in stock"):"Out of stock"})]}),(0,s.jsx)("button",{onClick:()=>{(0,c.Xq)(t,1),o.ZP.success("Added ".concat(t.name," to cart!"))},disabled:t.stock<=0,className:"mt-3 w-full btn ".concat(t.stock>0?"btn-primary":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Add to Cart"})]})]})})},l=r(7829),d=()=>{let[e,t]=(0,n.useState)([]),[r,c]=(0,n.useState)(!0),[o,d]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=async()=>{try{c(!0);let e=await (0,l.t2)();t(e),d(null)}catch(e){console.error("Failed to fetch products:",e),d("Failed to load products. Please try again later.")}finally{c(!1)}};e()},[]),(0,s.jsx)(a.Z,{title:"Products | Microservices Shop",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Products"}),r&&(0,s.jsx)("div",{className:"text-center py-10",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Loading products..."})}),o&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:(0,s.jsx)("p",{children:o})}),!r&&!o&&0===e.length&&(0,s.jsx)("div",{className:"text-center py-10",children:(0,s.jsx)("p",{className:"text-gray-500",children:"No products available at the moment."})}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:e.map(e=>(0,s.jsx)(i,{product:e},e.id))})]})})}},7829:function(e,t,r){"use strict";r.d(t,{LV:function(){return x},fA:function(){return u},pB:function(){return l},t2:function(){return i},wK:function(){return d}});var s=r(7066),n=r(6501);let a=s.Z.create({baseURL:"http://localhost:3000",timeout:1e4,headers:{"Content-Type":"application/json"}}),c=s.Z.create({baseURL:"http://localhost:3001",timeout:1e4,headers:{"Content-Type":"application/json"}}),o=e=>{if(s.Z.isAxiosError(e)){var t,r;let s=(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||e.message||"An error occurred";throw console.error("API Error:",s),n.ZP.error(s),Error(s)}throw console.error("Unexpected error:",e),n.ZP.error("An unexpected error occurred"),e},i=async()=>{try{let e=await c.get("/products");return e.data}catch(e){return o(e)}},l=async e=>{try{let t=await a.get("/customers/".concat(e));return t.data}catch(e){return o(e)}},d=async e=>{try{let t=await a.post("/customers",e);return t.data}catch(e){return o(e)}},u=async e=>{try{let t=await c.get("/orders/customer/".concat(e));return t.data}catch(e){return o(e)}},x=async(e,t)=>{try{let r=t.map(e=>({productId:e.productId,quantity:e.quantity,price:e.product.price})),s=await c.post("/orders",{customerId:e,items:r,status:"pending"});return s.data}catch(e){return o(e)}}},9635:function(e,t,r){"use strict";r.d(t,{I3:function(){return i},LL:function(){return o},Xq:function(){return n},a3:function(){return a},dv:function(){return s},h2:function(){return c}});let s=()=>{let e=localStorage.getItem("cart");return e?JSON.parse(e):[]},n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=s(),n=r.findIndex(t=>t.productId===e.id);n>=0?r[n].quantity+=t:r.push({productId:e.id,product:e,quantity:t}),localStorage.setItem("cart",JSON.stringify(r))},a=(e,t)=>{let r=s(),n=r.findIndex(t=>t.productId===e);n>=0&&(t<=0?r.splice(n,1):r[n].quantity=t,localStorage.setItem("cart",JSON.stringify(r)))},c=e=>{let t=s(),r=t.filter(t=>t.productId!==e);localStorage.setItem("cart",JSON.stringify(r))},o=()=>{localStorage.setItem("cart",JSON.stringify([]))},i=()=>{let e=s();return e.reduce((e,t)=>e+t.product.price*t.quantity,0)}}},function(e){e.O(0,[949,66,774,888,179],function(){return e(e.s=4918)}),_N_E=e.O()}]);